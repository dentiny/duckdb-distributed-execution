# name: test/sql/remote_execution.test
# description: test motherduck extension to perform remote execution
# group: [sql]

require motherduck

statement ok
ATTACH DATABASE 'md' (TYPE motherduck);

statement ok
PRAGMA md_register_remote_table('my_table', 'http://localhost:8080', 'my_table');

statement ok
CREATE TABLE md.my_table (id INTEGER, name TEXT, age INTEGER);

# Validate row insertions.
statement ok
INSERT INTO md.my_table VALUES (1, 'Server_Alice', 100), (2, 'Server_Bob', 200), (3, 'Server_Charlie', 300);

query III
SELECT * FROM md.my_table;
----
1	Server_Alice	100
2	Server_Bob	200
3	Server_Charlie	300

# Validation row deletions.
statement ok
DELETE FROM md.my_table WHERE id=1;

query III
SELECT * FROM md.my_table;
----
2	Server_Bob	200
3	Server_Charlie	300

# Validate all rows deletion.
statement ok
DELETE FROM md.my_table WHERE id=2 OR id=3;

query III
SELECT * FROM md.my_table;
----

# Validate table schema, creation and drop.
statement ok
DROP TABLE md.my_table;

query II
SELECT database_name, table_name FROM duckdb_tables();
----
