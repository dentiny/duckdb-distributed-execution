# name: test/sql/remote_execution.test
# description: test duckherder extension to perform remote execution
# group: [sql]

# TODO(hjiang): Temporarily disable due to non-reproducible NULL unique pointer access, which only happens on community extension CI.

# require duckherder

# statement ok
# SELECT duckherder_start_local_server(8823);

# statement ok
# ATTACH DATABASE 'dh' (TYPE duckherder, server_host 'localhost', server_port 8823);

# statement ok
# PRAGMA duckherder_register_remote_table('remote_exec_table', 'remote_exec_table');

# statement ok
# DROP TABLE IF EXISTS dh.remote_exec_table;

# statement ok
# CREATE TABLE dh.remote_exec_table (id INTEGER, name TEXT, age INTEGER);

# # Validate row insertions.
# statement ok
# INSERT INTO dh.remote_exec_table VALUES (1, 'Server_Alice', 100), (2, 'Server_Bob', 200), (3, 'Server_Charlie', 300);

# query III
# SELECT * FROM dh.remote_exec_table;
# ----
# 1	Server_Alice	100
# 2	Server_Bob	200
# 3	Server_Charlie	300

# # Validation row deletions.
# statement ok
# DELETE FROM dh.remote_exec_table WHERE id=1;

# query III
# SELECT * FROM dh.remote_exec_table;
# ----
# 2	Server_Bob	200
# 3	Server_Charlie	300

# # Validate all rows deletion.
# statement ok
# DELETE FROM dh.remote_exec_table WHERE id=2 OR id=3;

# query III
# SELECT * FROM dh.remote_exec_table;
# ----

# # Validate table schema, creation and drop.
# statement ok
# DROP TABLE dh.remote_exec_table;

# query II
# SELECT database_name, table_name FROM duckdb_tables();
# ----
